<!doctype html>
<html lang="en">
<head><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>Select seats — GoGlobal</title>
<link rel="stylesheet" href="flights.css"></head>
<body>
<header class="gg-header"><div class="container header-inner"><a class="logo" href="index.html">Go-Global Recruitment</a></div></header>
<main class="container" style="padding-top:20px">
  <div style="display:flex;justify-content:space-between;align-items:center">
    <div>
      <div style="font-size:12px;color:var(--muted)">Choose seats</div>
      <div style="font-size:20px;font-weight:800" id="bookingTitle"></div>
    </div>
    <div>
      <a class="btn" href="results.html">Back to results</a>
    </div>
  </div>

  <div style="display:flex;gap:18px;margin-top:18px;flex-wrap:wrap">
    <div style="flex:1;min-width:320px;background:var(--card);padding:16px;border-radius:12px;border:1px solid #eef2f6">
      <div style="font-weight:700;margin-bottom:8px">Seat map</div>
      <div id="seatMap" aria-label="Seat map"></div>
      <div style="margin-top:12px;color:var(--muted);font-size:13px">Click to select seats. Occupied seats are greyed out.</div>
    </div>

    <aside style="width:360px;min-width:260px">
      <div style="background:var(--card);padding:16px;border-radius:12px;border:1px solid #eef2f6">
        <div style="font-weight:700">Booking summary</div>
        <div id="summary" style="margin-top:8px;color:var(--muted)"></div>
        <div style="margin-top:12px">
          <button id="proceed" class="btn primary">Proceed to payment</button>
        </div>
      </div>
    </aside>
  </div>
</main>

<script>
// seat-selection client logic
const booking = JSON.parse(sessionStorage.getItem('gg_booking') || 'null');
if(!booking){ alert('No booking selected'); location.href='results.html'; }
document.getElementById('bookingTitle').textContent = `${booking.airline} • ${booking.origin} → ${booking.dest}`;
document.getElementById('summary').innerHTML = `<div>Price: <strong>ZAR ${Number(booking.price).toLocaleString()}</strong></div><div id="selectedSeats" style="margin-top:8px;color:var(--muted)"></div>`;

const seatMap = document.getElementById('seatMap');
// Example seat availability - in production, seat map should come from flights.json
const occupied = ['A1','A3','B2','C4'];
function buildSeatMap(rows=8, cols=6){
  for(let r=0;r<rows;r++){
    const row = document.createElement('div'); row.className='seat-row';
    for(let c=0;c<cols;c++){
      const id = String.fromCharCode(65+r) + (c+1);
      const b = document.createElement('button'); b.className='seat'; b.textContent = id;
      if(occupied.includes(id)) b.classList.add('occupied');
      b.addEventListener('click', ()=>{
        if(b.classList.contains('occupied')) return;
        b.classList.toggle('selected');
        updateSelected();
      });
      row.appendChild(b);
    }
    seatMap.appendChild(row);
  }
}
function updateSelected(){
  const selected = Array.from(document.querySelectorAll('.seat.selected')).map(s=>s.textContent);
  document.getElementById('selectedSeats').textContent = selected.length ? 'Seats: ' + selected.join(', ') : 'No seats selected';
}
buildSeatMap();

document.getElementById('proceed').addEventListener('click', ()=>{
  const selected = Array.from(document.querySelectorAll('.seat.selected')).map(s=>s.textContent);
  if(selected.length===0){ alert('Please select at least one seat.'); return; }
  booking.seats = selected;
  sessionStorage.setItem('gg_booking', JSON.stringify(booking));
  location.href = 'payment.html';
});
</script>
</body>
</html>
