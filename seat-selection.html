<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Select Flight</title>
<style>
#booking-mirror{font-family:Arial,Helvetica,sans-serif;color:#222}
#booking-mirror .container{max-width:1000px;margin:24px auto;padding:0 16px}
#booking-mirror .card{background:#fff;border-radius:8px;padding:16px;border:1px solid #eef2f6}
#booking-mirror .flight-head{display:flex;justify-content:space-between;align-items:center}
#booking-mirror .meta{color:#666;font-size:13px}
#booking-mirror .btn{padding:10px 14px;border-radius:6px;border:0;cursor:pointer}
#booking-mirror .btn.primary{background:#f5a623;color:#fff;font-weight:700}
#booking-mirror .detail-row{display:flex;gap:12px;align-items:center;padding:10px 0;border-bottom:1px dashed #eef2f6}
@media (max-width:700px){ #booking-mirror .flight-head{flex-direction:column;align-items:flex-start} }
</style>
</head>
<body>
<div id="booking-mirror">
  <main class="container">
    <a href="flight-search.html" class="small">&larr; Back to search</a>
    <div class="card" id="flightCard" aria-live="polite">
      <div class="flight-head">
        <div>
          <h2 id="route" style="margin:0"></h2>
          <div class="meta" id="airlineLine"></div>
        </div>
        <div style="text-align:right">
          <div style="font-weight:800;font-size:20px" id="price"></div>
          <div class="meta">per passenger</div>
          <div style="margin-top:8px"><button id="chooseSeats" class="btn primary">Choose seats & continue</button></div>
        </div>
      </div>

      <div id="details" style="margin-top:14px">
        <!-- dynamic -->
      </div>
    </div>
  </main>
</div>

<script>
(function(){
  function qs(key){
    const p = new URLSearchParams(location.search);
    return p.get(key);
  }
  const fid = qs('flight');
  const STORAGE_KEY = 'booking_mirror_flights';
  const flights = JSON.parse(localStorage.getItem(STORAGE_KEY) || '[]');
  const flight = flights.find(f=>f.id===fid);
  if(!flight){
    document.getElementById('flightCard').innerHTML = '<p class="small">Flight not found. Go back to search.</p>';
    return;
  }

  document.getElementById('route').textContent = `${flight.from} → ${flight.to}`;
  document.getElementById('airlineLine').textContent = `${flight.airline} • ${flight.stops} • ${flight.duration}`;
  document.getElementById('price').textContent = 'ZAR ' + flight.price.toLocaleString();

  const details = document.getElementById('details');
  details.innerHTML = `
    <div class="detail-row"><div><strong>Departure</strong><div class="meta">${new Date(flight.departISO).toLocaleString()}</div></div></div>
    <div class="detail-row"><div><strong>Arrival</strong><div class="meta">${new Date(flight.arriveISO).toLocaleString()}</div></div></div>
    <div class="detail-row"><div><strong>Baggage</strong><div class="meta">${flight.baggage}</div></div></div>
    <div class="detail-row"><div><strong>Duration</strong><div class="meta">${flight.duration}</div></div></div>
    <div style="padding-top:10px"><small class="meta">Cabin options: ${flight.cabinOptions.join(', ')}</small></div>
  `;

  document.getElementById('chooseSeats').addEventListener('click', function(){
    // pass along flight id and selected price
    const qs = new URLSearchParams({flight: fid});
    location.href = `select-seat.html?${qs.toString()}`;
  });
})();
</script>
</body>
</html>
