// Realistic dummy flight data
const flightData = [
    {from:"Cape Town", to:"Johannesburg", airline:"South African Airways", stops:0, departure:"08:00", arrival:"10:00", duration:"2h", price:193, logo:"https://content.airlinelogos.com/airlines/saa.png"},
    {from:"Cape Town", to:"Durban", airline:"Emirates", stops:1, departure:"09:00", arrival:"11:45", duration:"2h 45m", price:183, logo:"https://content.airlinelogos.com/airlines/emirates.png"},
    {from:"Cape Town", to:"Port Elizabeth", airline:"British Airways", stops:0, departure:"07:30", arrival:"09:15", duration:"1h 45m", price:236, logo:"https://content.airlinelogos.com/airlines/ba.png"},
    {from:"Cape Town", to:"London", airline:"British Airways", stops:1, departure:"22:00", arrival:"10:00+1", duration:"12h", price:423, logo:"https://content.airlinelogos.com/airlines/ba.png"},
    {from:"Cape Town", to:"New York", airline:"Emirates", stops:1, departure:"20:00", arrival:"06:00+1", duration:"15h", price:845, logo:"https://content.airlinelogos.com/airlines/emirates.png"},
    {from:"Cape Town", to:"Dubai", airline:"Emirates", stops:0, departure:"16:00", arrival:"00:00+1", duration:"8h", price:503, logo:"https://content.airlinelogos.com/airlines/emirates.png"}
];

// Populate flights
function displayFlights(data){
    const container = document.querySelector(".flights-results");
    container.innerHTML = "";
    data.forEach(flight=>{
        const card = document.createElement("div");
        card.className = "flight-card";
        card.innerHTML = `
            <div class="flight-info">
                <img src="${flight.logo}" alt="${flight.airline}">
                <div>${flight.airline}</div>
                <div class="flight-times">${flight.departure} - ${flight.arrival}</div>
                <div class="flight-duration">${flight.duration} | ${flight.stops} stops</div>
            </div>
            <div class="flight-price">$${flight.price}</div>
            <button class="select-btn">Select</button>
        `;
        container.appendChild(card);
    });
}

// Initial display
displayFlights(flightData);

// Filters
document.querySelectorAll(".stops-filter, .airline-filter").forEach(input=>{
    input.addEventListener("change",()=>{
        let filtered = flightData.slice();
        const stopsChecked = Array.from(document.querySelectorAll(".stops-filter:checked")).map(i=>parseInt(i.value));
        if(stopsChecked.length>0){
            filtered = filtered.filter(f=>stopsChecked.includes(f.stops));
        }
        const airlineChecked = Array.from(document.querySelectorAll(".airline-filter:checked")).map(i=>i.value);
        if(airlineChecked.length>0){
            filtered = filtered.filter(f=>airlineChecked.includes(f.airline));
        }
        displayFlights(filtered);
    });
});

// Sort
document.getElementById("sort").addEventListener("change", (e)=>{
    let sorted = flightData.slice();
    if(e.target.value==="price") sorted.sort((a,b)=>a.price-b.price);
    if(e.target.value==="duration") sorted.sort((a,b)=>{
        const dA = parseInt(a.duration);
        const dB = parseInt(b.duration);
        return dA-dB;
    });
    if(e.target.value==="departure") sorted.sort((a,b)=>a.departure.localeCompare(b.departure));
    displayFlights(sorted);
});

// Search
document.getElementById("flight-search").addEventListener("submit", e=>{
    e.preventDefault();
    const from = document.getElementById("from").value.toLowerCase();
    const to = document.getElementById("to").value.toLowerCase();
    const filtered = flightData.filter(f=>f.from.toLowerCase().includes(from) && f.to.toLowerCase().includes(to));
    displayFlights(filtered);
});
