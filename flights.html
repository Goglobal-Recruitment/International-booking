<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Flight Selection</title>
<link rel="stylesheet" href="css/style.css" />
<style>
body{font-family:"Helvetica Neue",Arial,sans-serif;margin:0;padding:0;background:#f5f5f5}
.container{max-width:1100px;margin:0 auto;padding:20px}
.header{background:#0b4a84;color:#fff;padding:24px;text-align:center;font-size:24px;font-weight:700}
.flight-card{background:#fff;border-radius:8px;padding:16px;display:flex;justify-content:space-between;align-items:center;box-shadow:0 4px 12px rgba(0,0,0,0.1);margin-bottom:16px}
.seat-map{display:grid;grid-template-columns:repeat(6,40px);gap:8px;margin-top:16px}
.seat{width:40px;height:40px;background:#eef7ff;border-radius:4px;display:flex;align-items:center;justify-content:center;cursor:pointer;font-size:14px}
.seat.selected{background:#0b4a84;color:#fff}
.seat.occupied{background:#ccc;cursor:not-allowed}
.extras{margin-top:16px;display:flex;gap:12px;flex-wrap:wrap}
.extras label{display:flex;align-items:center;gap:6px}
button.primary{background:#ffb400;color:#0b2b4a;font-weight:700;border:none;padding:12px 24px;border-radius:6px;cursor:pointer;font-size:16px;margin-top:16px}
</style>
</head>
<body>
<div class="header">Select Your Seat</div>
<div class="container">
  <div id="flight-info" class="flight-card"></div>

  <div>
    <h3>Choose Your Seat</h3>
    <div id="seat-map" class="seat-map"></div>
  </div>

  <div class="extras">
    <label><input type="checkbox" id="extra-baggage"> Extra Baggage</label>
    <label><input type="checkbox" id="meal"> Meal</label>
  </div>

  <button class="primary" id="continueBtn">Continue</button>
</div>

<script>
(function(){
  const flight = JSON.parse(localStorage.getItem('selectedFlight'));
  if(!flight){ alert('No flight selected. Redirecting.'); location.href='index.html'; }

  // Show flight info
  const flightInfoEl = document.getElementById('flight-info');
  flightInfoEl.innerHTML = `
    <div>
      <div style="font-weight:700">${flight.airline} - ${flight.from} → ${flight.to}</div>
      <div>${new Date(flight.departISO).toLocaleTimeString([], {hour:'2-digit',minute:'2-digit'})} → ${new Date(flight.arriveISO).toLocaleTimeString([], {hour:'2-digit',minute:'2-digit'})}</div>
      <div>Stops: ${flight.stops} • Duration: ${flight.duration}</div>
      <div>Baggage: ${flight.baggage}</div>
    </div>
    <div style="font-weight:800;font-size:18px">ZAR ${flight.price.toLocaleString()}</div>
  `;

  // Seat Map
  const seatMapEl = document.getElementById('seat-map');
  const seatMap = flight.seatMap;
  seatMap.forEach(row=>{
    Object.keys(row.seats).forEach(s=>{
      const seat = document.createElement('div');
      seat.className='seat'+(row.seats[s].available?'':' occupied');
      seat.textContent=row.row+s;
      seat.dataset.row=row.row;
      seat.dataset.seat=s;
      seat.addEventListener('click', function(){
        if(this.classList.contains('occupied')) return;
        document.querySelectorAll('.seat.selected').forEach(e=>e.classList.remove('selected'));
        this.classList.add('selected');
      });
      seatMapEl.appendChild(seat);
    });
  });

  document.getElementById('continueBtn').addEventListener('click', ()=>{
    const selectedSeat = document.querySelector('.seat.selected');
    if(!selectedSeat){ alert('Please select a seat'); return; }
    const extras = {
      baggage: document.getElementById('extra-baggage').checked,
      meal: document.getElementById('meal').checked
    };
    localStorage.setItem('selectedSeat', JSON.stringify({
      seat: selectedSeat.dataset.row + selectedSeat.dataset.seat,
      extras
    }));
    location.href='passenger-info.html';
  });
})();
</script>
</body>
</html>
