// Dummy flight data with international flights
const flights = [
  {from:"Cape Town", to:"London", airline:"British Airways", stops:1, departure:"22:00", arrival:"10:00+1", duration:"12h", price:423, logo:"https://content.airlinelogos.com/airlines/ba.png"},
  {from:"Johannesburg", to:"New York", airline:"Emirates", stops:1, departure:"20:00", arrival:"06:00+1", duration:"15h", price:845, logo:"https://content.airlinelogos.com/airlines/emirates.png"},
  {from:"Cape Town", to:"Dubai", airline:"Emirates", stops:0, departure:"16:00", arrival:"00:00+1", duration:"8h", price:503, logo:"https://content.airlinelogos.com/airlines/emirates.png"},
  {from:"Durban", to:"London", airline:"British Airways", stops:1, departure:"21:00", arrival:"09:00+1", duration:"12h", price:436, logo:"https://content.airlinelogos.com/airlines/ba.png"},
  {from:"Cape Town", to:"New York", airline:"Emirates", stops:1, departure:"19:00", arrival:"05:00+1", duration:"15h", price:862, logo:"https://content.airlinelogos.com/airlines/emirates.png"}
];

const container = document.querySelector(".flights-results");

function renderFlights(data) {
    container.innerHTML = "";
    data.forEach(f => {
        const card = document.createElement("div");
        card.className = "flight-card";
        card.innerHTML = `
            <div class="flight-header">
                <div class="airline-info">
                    <img class="airline-logo" src="${f.logo}" alt="${f.airline}">
                    <div class="airline-details">
                        <span class="airline-name">${f.airline}</span>
                        <span class="flight-number">Flight #${Math.floor(Math.random()*900+100)}</span>
                    </div>
                </div>
                <div class="flight-route">
                    <div class="departure">
                        <div class="time">${f.departure}</div>
                        <div class="airport">${f.from}</div>
                    </div>
                    <div class="flight-path">
                        <div class="flight-line"></div>
                        <div class="duration">${f.duration}</div>
                        <div class="stops">${f.stops===0 ? "Non-stop" : f.stops+" Stop(s)"}</div>
                    </div>
                    <div class="arrival">
                        <div class="time">${f.arrival}</div>
                        <div class="airport">${f.to}</div>
                    </div>
                </div>
                <div class="flight-price">
                    <div class="price-from">from</div>
                    <div class="price-amount">$${f.price}</div>
                    <div class="price-per-person">per person</div>
                </div>
            </div>
            <button class="select-btn">Select</button>
        `;
        container.appendChild(card);
    });
}

// Initial render
renderFlights(flights);

// Simple Search
document.getElementById("flight-search").addEventListener("submit", e => {
    e.preventDefault();
    const from = document.getElementById("from").value.toLowerCase();
    const to = document.getElementById("to").value.toLowerCase();
    const filtered = flights.filter(f => f.from.toLowerCase().includes(from) && f.to.toLowerCase().includes(to));
    renderFlights(filtered);
});

// Filters (stops and airlines)
document.querySelectorAll(".stops-filter, .airline-filter").forEach(input => {
    input.addEventListener("change", () => {
        let filtered = flights.slice();
        const stopsChecked = Array.from(document.querySelectorAll(".stops-filter:checked")).map(i=>parseInt(i.value));
        if(stopsChecked.length) filtered = filtered.filter(f=>stopsChecked.includes(f.stops));
        const airlineChecked = Array.from(document.querySelectorAll(".airline-filter:checked")).map(i=>i.value);
        if(airlineChecked.length) filtered = filtered.filter(f=>airlineChecked.includes(f.airline));
        renderFlights(filtered);
    });
});

// Sort
document.getElementById("sort").addEventListener("change", e => {
    let sorted = flights.slice();
    if(e.target.value==="price") sorted.sort((a,b)=>a.price-b.price);
    if(e.target.value==="duration") sorted.sort((a,b)=>parseInt(a.duration)-parseInt(b.duration));
    if(e.target.value==="departure") sorted.sort((a,b)=>a.departure.localeCompare(b.departure));
    renderFlights(sorted);
});
